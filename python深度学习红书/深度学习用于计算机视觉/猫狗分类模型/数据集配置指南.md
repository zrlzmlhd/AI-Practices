# 猫狗分类数据集下载和路径配置指南

## 数据集下载

### 方法1: Kaggle下载 (推荐)
1. 访问 [Kaggle Dogs vs. Cats](https://www.kaggle.com/c/dogs-vs-cats/data)
2. 下载 `train.zip` 和 `test1.zip`
3. 解压到 `data/cats_and_dogs/` 目录

### 方法2: 使用Kaggle API
```bash
# 安装kaggle
pip install kaggle

# 配置API密钥 (从kaggle.com/account下载kaggle.json)
mkdir ~/.kaggle
cp kaggle.json ~/.kaggle/
chmod 600 ~/.kaggle/kaggle.json

# 下载数据集
kaggle competitions download -c dogs-vs-cats
unzip dogs-vs-cats.zip -d data/cats_and_dogs/
```

## 目录结构

下载后，请确保目录结构如下：

```
data/
└── cats_and_dogs/
    ├── train/
    │   ├── cats/
    │   │   ├── cat.0.jpg
    │   │   ├── cat.1.jpg
    │   │   └── ...
    │   └── dogs/
    │       ├── dog.0.jpg
    │       ├── dog.1.jpg
    │       └── ...
    ├── validation/
    │   ├── cats/
    │   └── dogs/
    └── test/
        ├── cats/
        └── dogs/
```

## 数据集划分脚本

如果原始数据没有划分，可以使用以下脚本：

```python
import os
import shutil
from pathlib import Path

def split_dataset(source_dir, target_dir, train_ratio=0.7, val_ratio=0.15):
    """
    将数据集划分为训练集、验证集和测试集

    Args:
        source_dir: 原始数据目录
        target_dir: 目标目录
        train_ratio: 训练集比例
        val_ratio: 验证集比例
    """
    import random
    random.seed(42)

    for class_name in ['cats', 'dogs']:
        source_class_dir = Path(source_dir) / class_name
        if not source_class_dir.exists():
            # 如果没有子目录，尝试按文件名前缀分类
            source_class_dir = Path(source_dir)
            prefix = 'cat' if class_name == 'cats' else 'dog'
            files = [f for f in source_class_dir.glob(f'{prefix}*.jpg')]
        else:
            files = list(source_class_dir.glob('*.jpg'))

        random.shuffle(files)

        n_train = int(len(files) * train_ratio)
        n_val = int(len(files) * val_ratio)

        splits = {
            'train': files[:n_train],
            'validation': files[n_train:n_train + n_val],
            'test': files[n_train + n_val:]
        }

        for split_name, split_files in splits.items():
            target_class_dir = Path(target_dir) / split_name / class_name
            target_class_dir.mkdir(parents=True, exist_ok=True)

            for f in split_files:
                shutil.copy(f, target_class_dir / f.name)

        print(f"{class_name}: train={n_train}, val={n_val}, test={len(files)-n_train-n_val}")

# 使用示例
# split_dataset('path/to/original/train', 'data/cats_and_dogs')
```

## 在Notebook中配置路径

在notebook开头添加以下配置：

```python
from pathlib import Path

# ============================================================
# 数据路径配置 - 请根据您的环境修改
# ============================================================

# 方法1: 使用相对路径 (推荐)
DATA_DIR = Path("../../../data/cats_and_dogs")

# 方法2: 使用utils模块
# from utils import get_data_path
# DATA_DIR = get_data_path("cats_and_dogs")

# 方法3: 使用绝对路径
# DATA_DIR = Path("/path/to/your/data/cats_and_dogs")

# 验证路径
TRAIN_DIR = DATA_DIR / "train"
VALIDATION_DIR = DATA_DIR / "validation"
TEST_DIR = DATA_DIR / "test"

print(f"训练目录: {TRAIN_DIR}")
print(f"验证目录: {VALIDATION_DIR}")
print(f"测试目录: {TEST_DIR}")

# 检查目录是否存在
for dir_path in [TRAIN_DIR, VALIDATION_DIR, TEST_DIR]:
    if dir_path.exists():
        print(f"✓ {dir_path.name} 目录存在")
    else:
        print(f"✗ {dir_path.name} 目录不存在，请检查路径配置")
```

## 常见问题

### Q: 找不到数据目录
A: 检查DATA_DIR路径是否正确，确保数据已下载并解压

### Q: 图片数量不对
A: 确保按照上述目录结构组织数据，每个类别应该有独立的子目录

### Q: 内存不足
A: 减小batch_size，或使用ImageDataGenerator的subset参数只加载部分数据
